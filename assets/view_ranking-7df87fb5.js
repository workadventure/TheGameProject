import"./main-531b8551.js";import{g as $,a as x,m as T,b as E,c as b}from"./firebase-a8cde200.js";import{t as h}from"./translate-df78904b.js";const g=10;document.addEventListener("DOMContentLoaded",async()=>{WA.onInit().then(async()=>{const t=await v();let m=await $(),e=await x();if(!e||!m){t!=null&&u(t);return}let a=0;for(const i in m)m[i].timestamp<a,a=m[i].timestamp;let n=0;for(const i in e)e[i].timestamp<n,n=e[i].timestamp;const o={myGame:n-a};t==null||t.push([T(),o.myGame]);const s=t==null?void 0:t.sort(([,i],[,d])=>i-d);u(s,T())})});const v=async()=>{const t=await E(),m=await b();if(!t||!m){WA.ui.modal.closeModal();return}const e={};for(const a in t){let n=0;for(const s in t[a])t[a][s].timestamp<t[a][s].timestamp,n=t[a][s].timestamp;if(!m[a])continue;let o=0;for(const s in m[a])m[a][s].timestamp<m[a][s].timestamp,o=m[a][s].timestamp;n===0||o===0||(e[a]=n-o)}return Object.entries(e)},u=(t,m)=>{const e=document.getElementById("ranking");e==null||e.childNodes.forEach(c=>c.remove());let a=!1;for(const[c,f]of t.slice(0,g).entries()){const y=f[0],G=f[1],w=Math.floor(G/6e4),S=Math.floor(G%6e4/1e3),M=`${w}min ${S}s`,l=document.createElement("p");l.classList.add("rank"),l.textContent=`#${c+1} ${y} : ${M}`,e==null||e.appendChild(l),a=a||y===m}if(m==null)return C();if(a)return;const n=t.findIndex(([c])=>m===c);if(n===-1)return;const s=t[n][1],i=Math.floor(s/6e4),d=Math.floor(s%6e4/1e3),I=`${i}min ${d}s`,p=document.createElement("p");p.textContent="...";const r=document.createElement("p");r.classList.add("rank"),r.id="myGame",r.textContent=`#${n+1} ${m} : ${I}`,e==null||e.appendChild(p),e==null||e.appendChild(r),A()},C=async()=>{const t=document.getElementById("title");t&&(t.innerText=await h("views.ranking.start.title"))},A=async()=>{const t=document.getElementById("title");t&&(t.innerText=await h("views.ranking.end.title"))};
