import{t as d}from"./translate-185f5959.js";import{f as W}from"./job-44d143fb.js";import{p as h}from"./sounds-0b5a1cc8.js";let u=null;const e=(r,i=null)=>{const l=WA.state.mapWidth,t=WA.state.mapHeight,a=[];if(i)for(let o=1;o<i.length;o++)a.push({x:i[o].x,y:i[o].y,tile:null,layer:`${r}/block`});else for(let o=1;o<l;o++)for(let m=1;m<t;m++)a.push({x:o,y:m,tile:null,layer:`${r}/block`});WA.room.setTiles(a)},n=(r=["secretPassageZone"],i=null,l=null)=>{for(let t=0;t<r.length;t++)WA.state[`${r[t]}Discovered`]?(WA.room.hideLayer(`${r[t]}/trace`),WA.room.showLayer(`${r[t]}/found`),WA.room.hideLayer(`${r[t]}/disappear`),e(r[t],l?l[t]:null)):(W("findSecretPassages")?(WA.room.showLayer(`${r[t]}/trace`),WA.room.onEnterLayer(`${r[t]}/trace`).subscribe(()=>{WA.state[`${r[t]}Discovered`]||(u=WA.ui.displayActionMessage({message:d("utils.executeAction",{action:d("modules.secretPassage.findSecretPassage")}),callback:()=>{WA.state[`${r[t]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${r[t]}/trace`).subscribe(()=>{u==null||u.remove()})):WA.room.hideLayer(`${r[t]}/trace`),WA.state.onVariableChange(`${r[t]}Discovered`).subscribe(()=>{A(r[t],i?i[t]:null,l?l[t]:null)}))},A=(r,i=null,l=null)=>{WA.room.hideLayer(`${r}/trace`),WA.room.showLayer(`${r}/search`),setTimeout(()=>{WA.room.showLayer(`${r}/found`),WA.room.hideLayer(`${r}/disappear`),e(r,l),setTimeout(()=>{WA.room.hideLayer(`${r}/search`),h("successSound"),i&&i()},1e3)},3e3)};export{n as i,e as r};
