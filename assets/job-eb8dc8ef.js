import{t as r}from"./translate-d272070d.js";import{r as b}from"./sounds-5d3f972e.js";var W=(e=>(e.archaeologistPlayer="archaeologistPlayer",e.spyPlayer="spyPlayer",e))(W||{});const i="job",o={public:!0,persist:!0,scope:"world"},l={archaeologist:{useComputers:!1,speakAncienLanguages:!0,readRunes:!0,makeExcavation:!0,findSecretPassages:!1,makeHooking:!1},spy:{useComputers:!0,speakAncienLanguages:!1,readRunes:!1,makeExcavation:!1,findSecretPassages:!0,makeHooking:!0}},c="jobWalletButton";let s=null;const t=e=>{WA.player.state.saveVariable(i,e,o),WA.player.removeOutlineColor(),e==="spy"&&WA.player.setOutlineColor(0,0,0),e==="archaeologist"&&WA.player.setOutlineColor(85,53,42)},g=()=>{const e=WA.state.loadVariable("archaeologistPlayer");console.log("archaeologistPlayer",e);const a=WA.state.loadVariable("spyPlayer");console.log("spyPlayer",a),(e==null||e!==!1&&e.uuid===WA.player.uuid)&&WA.state.saveVariable("archaeologistPlayer",!1),(!a||a==null)&&WA.state.saveVariable("spyPlayer",{uuid:WA.player.uuid,name:WA.player.name}),t("spy")},P=()=>{const e=WA.state.loadVariable("archaeologistPlayer"),a=WA.state.loadVariable("spyPlayer");(!e||e==null)&&WA.state.saveVariable("archaeologistPlayer",{uuid:WA.player.uuid,name:WA.player.name}),(e==null||a!==!1&&a.uuid===WA.player.uuid)&&WA.state.saveVariable("spyPlayer",!1),t("archaeologist")},f=()=>{const e=WA.state.loadVariable("spyPlayer");e&&e.uuid!==WA.player.uuid||(WA.state.saveVariable("spyPlayer",!1),t(void 0))},h=()=>{const e=WA.state.loadVariable("archaeologistPlayer");e&&e.uuid!==WA.player.uuid&&WA.state.saveVariable("archaeologistPlayer",!1),t(void 0)},m=()=>WA.player.state.job,p=async()=>{WA.controls.disablePlayerControls(),s=await WA.ui.website.open({url:`${b}/views/jobWallet/jobWallet.html`,allowApi:!0,allowPolicy:"",position:{vertical:"middle",horizontal:"middle"},size:{height:"50vh",width:"50vw"}}),WA.player.state.saveVariable("askForJobWalletWebsiteClose",!1,o)},v=()=>{WA.player.state.saveVariable("askForJobWalletWebsiteClose",!0,o)},u=()=>{s==null||s.close(),s=null,WA.controls.restorePlayerControls()},n=()=>{WA.ui.actionBar.addButton({id:c,label:r("modules.job.myJobWallet.label"),callback:async()=>{s?u():await p()}})},y=()=>{WA.ui.actionBar.removeButton(c)},j=async()=>{WA.controls.disablePlayerControls(),console.info("initiateJob => My job is",WA.player.state.job),WA.player.state.job?n():(y(),WA.player.state.saveVariable(i,!1,o)),WA.player.state.onVariableChange(i).subscribe(e=>{e?(console.log(r("modules.job.jobChanged",{job:r(`modules.job.jobs.${e}`)})),n()):y()}),WA.player.state.onVariableChange("askForJobWalletWebsiteClose").subscribe(e=>{e&&u()}),WA.controls.restorePlayerControls()},V=e=>WA.player.state.job&&l[WA.player.state.job][e],J=()=>WA.player.state.job&&l[WA.player.state.job]?Object.keys(l[WA.player.state.job]).filter(e=>l[WA.player.state.job][e]):null;export{W as J,g as a,f as b,J as c,v as d,V as e,m as g,j as i,P as s,h as u};
