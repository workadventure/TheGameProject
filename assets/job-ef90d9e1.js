import{t as r}from"./translate-df78904b.js";import{j as c,k as W}from"./firebase-a8cde200.js";import{r as p}from"./config-3db041a0.js";var A=(e=>(e.archaeologistPlayer="archaeologistPlayer",e.spyPlayer="spyPlayer",e))(A||{});const i="job",o={public:!0,persist:!0,scope:"world"},t={archaeologist:{useComputers:!1,speakAncienLanguages:!0,readRunes:!0,makeExcavation:!0,findSecretPassages:!1,makeHooking:!1},spy:{useComputers:!0,speakAncienLanguages:!1,readRunes:!1,makeExcavation:!1,findSecretPassages:!0,makeHooking:!0}},u="jobWalletButton";let a=null;const l=e=>{WA.player.state.saveVariable(i,e,o),WA.player.removeOutlineColor(),e==="spy"&&WA.player.setOutlineColor(0,0,0),e==="archaeologist"&&WA.player.setOutlineColor(85,53,42),e&&W(e)},h=()=>{const e=WA.state.loadVariable("archaeologistPlayer"),s=WA.state.loadVariable("spyPlayer");(e==null||e!==!1&&e.uuid===WA.player.uuid)&&WA.state.saveVariable("archaeologistPlayer",!1),(!s||s==null)&&WA.state.saveVariable("spyPlayer",{uuid:WA.player.uuid,name:WA.player.name}),l("spy")},v=()=>{const e=WA.state.loadVariable("archaeologistPlayer"),s=WA.state.loadVariable("spyPlayer");(!e||e==null)&&WA.state.saveVariable("archaeologistPlayer",{uuid:WA.player.uuid,name:WA.player.name}),(e==null||s!==!1&&s.uuid===WA.player.uuid)&&WA.state.saveVariable("spyPlayer",!1),l("archaeologist")},j=()=>{const e=WA.state.loadVariable("spyPlayer");e&&e.uuid!==WA.player.uuid||(WA.state.saveVariable("spyPlayer",!1),l(void 0))},V=()=>{const e=WA.state.loadVariable("archaeologistPlayer");e&&e.uuid!==WA.player.uuid&&WA.state.saveVariable("archaeologistPlayer",!1),l(void 0)},d=async()=>{if(WA.player.state.job)return WA.player.state.job;const e=await c();return e==null?!1:(WA.player.state.job=e.job,e.job)},f=async()=>{WA.controls.disablePlayerControls(),a=await WA.ui.website.open({url:`${p}/views/jobWallet/jobWallet.html`,allowApi:!0,allowPolicy:"",position:{vertical:"middle",horizontal:"middle"},size:{height:"50vh",width:"50vw"}}),WA.player.state.saveVariable("askForJobWalletWebsiteClose",!1,o)},J=()=>{WA.player.state.saveVariable("askForJobWalletWebsiteClose",!0,o)},b=()=>{a==null||a.close(),a=null,WA.controls.restorePlayerControls()},n=()=>{WA.ui.actionBar.addButton({id:u,label:r("modules.job.myJobWallet.label"),callback:async()=>{a?b():await f()}})},y=()=>{WA.ui.actionBar.removeButton(u)},k=async()=>{WA.controls.disablePlayerControls(),await d(),console.info("initiateJob => My job is: ",WA.player.state.job),WA.player.state.job?n():(y(),WA.player.state.saveVariable(i,!1,o)),WA.player.state.onVariableChange(i).subscribe(e=>{e?(console.info(r("modules.job.jobChanged",{job:r(`modules.job.jobs.${e}`)})),n()):y()}),WA.player.state.onVariableChange("askForJobWalletWebsiteClose").subscribe(e=>{e&&b()}),WA.controls.restorePlayerControls()},C=e=>WA.player.state.job&&t[WA.player.state.job][e],w=()=>WA.player.state.job&&t[WA.player.state.job]?Object.keys(t[WA.player.state.job]).filter(e=>t[WA.player.state.job][e]):null;export{A as J,h as a,j as b,w as c,J as d,C as e,d as g,k as i,v as s,V as u};
